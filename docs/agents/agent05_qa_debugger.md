# Agent 05: QA & Debugger - 品質保証・デバッグ仕様書

## 1. 目的

バグ再現手順の特定、入力取りこぼしの修正、設定反映漏れの解消など、品質に関する問題を徹底的に洗い出し修正する。

### 基本方針
- **網羅的テスト**: すべての機能を漏れなくテスト
- **再現性重視**: バグを確実に再現できる手順を記録
- **ユーザー視点**: 実際の利用シーンを想定したテスト
- **アクセシビリティ確認**: 操作方法ごとの動作確認

---

## 2. やること（チェックリスト）

### 2.1 手動テストチェックリスト

#### 画面遷移テスト
- [ ] Home → Game A（ゲーム開始）
- [ ] Home → Game B（ゲーム開始）
- [ ] Home → Game C（ゲーム開始）
- [ ] Home → Settings（設定画面）
- [ ] Home → Help（ヘルプ画面）
- [ ] Settings → Home（戻る）
- [ ] Help → Home（戻る）
- [ ] Game → Result（ゲーム終了）
- [ ] Result → Home（ホームへ）
- [ ] Result → Game（リトライ）
- [ ] Game → Pause → Home（途中終了）
- [ ] Game → Pause → Resume（再開）

#### 入力テスト（各画面）
| 画面 | マウス | タッチ | キーボード |
|------|--------|--------|------------|
| Home | [ ] | [ ] | [ ] |
| Settings | [ ] | [ ] | [ ] |
| Help | [ ] | [ ] | [ ] |
| Game A | [ ] | [ ] | [ ] |
| Game B | [ ] | [ ] | [ ] |
| Game C | [ ] | [ ] | [ ] |
| Result | [ ] | [ ] | [ ] |
| HUD | [ ] | [ ] | [ ] |

#### キーボード操作詳細テスト
- [ ] Tab: 次の要素にフォーカス移動
- [ ] Shift+Tab: 前の要素にフォーカス移動
- [ ] Enter: ボタン押下
- [ ] Space: ボタン押下
- [ ] Escape: ホームへ戻る
- [ ] R: リトライ（結果画面）
- [ ] 矢印キー: 選択肢の移動

### 2.2 各ゲームの動作確認

#### Game A: 視線レール追視
- [ ] **レール表示**
  - [ ] 直線レールが正しく表示される
  - [ ] S字レールが正しく表示される
  - [ ] 円形レールが正しく表示される
- [ ] **ターゲット動作**
  - [ ] ターゲットがレール上を移動する
  - [ ] 移動速度が設定通り
  - [ ] 端に到達したら折り返すまたは終了
- [ ] **ゲーム進行**
  - [ ] 開始前の準備画面が表示される
  - [ ] ゲームが正常に開始する
  - [ ] ゲームが正常に終了する
  - [ ] 一時停止が機能する
  - [ ] 再開が機能する

#### Game B: 行読みガイド
- [ ] **行表示**
  - [ ] 指定行数が表示される
  - [ ] 行間が適切
  - [ ] ガイド線が見やすい
- [ ] **ターゲット配置**
  - [ ] 各行にターゲットが配置される
  - [ ] 配置位置が適切
- [ ] **選択動作**
  - [ ] タッチ/クリックで選択できる
  - [ ] 正しい順序で選択できる
  - [ ] 正解時のフィードバックがある
  - [ ] 間違い時のヒントがある
  - [ ] 次のターゲットが分かる
- [ ] **ゲーム進行**
  - [ ] すべて選択で終了する
  - [ ] 結果が正しく表示される

#### Game C: 予告付き視線切り替え
- [ ] **予告表示**
  - [ ] 薄い色で予告が表示される
  - [ ] 予告時間が適切（1〜2秒）
- [ ] **本表示**
  - [ ] 予告位置に本表示される
  - [ ] 表示時間が十分（3秒以上）
- [ ] **パターン**
  - [ ] 左右交互パターンが機能
  - [ ] 上下交互パターンが機能
  - [ ] 四隅パターンが機能
- [ ] **選択動作**
  - [ ] ターゲット選択が判定される
  - [ ] 次のターゲットへ進む

### 2.3 設定の保存・復元確認

#### 設定項目ごとの確認
| 設定項目 | 変更 | 保存 | 復元 | 反映 |
|---------|------|------|------|------|
| 速度（slow/normal） | [ ] | [ ] | [ ] | [ ] |
| ガイド表示 ON/OFF | [ ] | [ ] | [ ] | [ ] |
| 音量（0-100） | [ ] | [ ] | [ ] | [ ] |
| 効果音 ON/OFF | [ ] | [ ] | [ ] | [ ] |
| 背景色（white/cream/gray/dark） | [ ] | [ ] | [ ] | [ ] |
| 文字サイズ（medium/large/xlarge） | [ ] | [ ] | [ ] | [ ] |

#### 設定反映確認
- [ ] 背景色変更が即座に反映される
- [ ] 文字サイズ変更が即座に反映される
- [ ] 音量変更が効果音に反映される
- [ ] 速度設定がゲームに反映される
- [ ] ガイド設定がゲームに反映される

#### 保存・復元テスト
- [ ] 設定変更後にブラウザを閉じる
- [ ] 再度開いて設定が復元されている
- [ ] localStorage.clear()後に初期値になる

### 2.4 キーボード操作確認

#### フォーカス表示
- [ ] フォーカス中の要素が視覚的に分かる
- [ ] フォーカス枠が十分な太さ
- [ ] 高コントラストモードでも見える

#### 全画面でのキーボードナビゲーション
| 画面 | Tab移動 | Enter押下 | Escape |
|------|---------|-----------|--------|
| Home | [ ] | [ ] | [ ] |
| Settings | [ ] | [ ] | [ ] |
| Help | [ ] | [ ] | [ ] |
| Game中 | [ ] | [ ] | [ ] |
| Pause | [ ] | [ ] | [ ] |
| Result | [ ] | [ ] | [ ] |

---

## 3. 成果物

### 3.1 テスト結果記録表

```markdown
# テスト結果記録

## テスト実施情報
- 実施日: YYYY-MM-DD
- 実施者:
- ブラウザ: Chrome XX / Firefox XX / Safari XX
- デバイス:

## 結果サマリー
- 合格: XX項目
- 不合格: XX項目
- 未実施: XX項目

## 不合格項目詳細
| No | 項目 | 期待結果 | 実際の結果 | 再現手順 |
|----|------|---------|-----------|---------|
| 1  |      |         |           |         |

## 備考
```

### 3.2 バグ報告テンプレート

```markdown
# バグ報告

## 概要
[バグの簡潔な説明]

## 再現手順
1. [手順1]
2. [手順2]
3. [手順3]

## 期待される動作
[正常時の動作]

## 実際の動作
[バグ発生時の動作]

## 環境
- ブラウザ:
- OS:
- 画面サイズ:

## スクリーンショット
[該当する場合]

## 優先度
- [ ] 高（機能不全）
- [ ] 中（機能低下）
- [ ] 低（軽微な問題）

## 関連ファイル
[関係するソースファイル]
```

### 3.3 手動テスト手順書

#### テスト準備
1. ブラウザのキャッシュをクリア
2. localStorageをクリア（開発者ツール → Application → Clear storage）
3. ブラウザをリロード

#### 基本動作テスト手順

##### Home画面テスト
```
1. アプリを開く
2. 「めのうんどう」タイトルが表示されることを確認
3. ゲーム選択ボタン（A/B/C）が表示されることを確認
4. 「せってい」ボタンが表示されることを確認
5. 各ボタンにTabでフォーカス移動できることを確認
6. Enterでボタンが押下されることを確認
```

##### 設定画面テスト手順
```
1. Home画面から「せってい」をクリック
2. 設定画面に遷移することを確認（フェードイン）
3. 各設定項目が表示されることを確認
4. 背景色を「cream」に変更
5. 即座に背景色が変わることを確認
6. 文字サイズを「xlarge」に変更
7. 即座に文字サイズが変わることを確認
8. 「もどる」をクリック
9. Home画面に戻ることを確認
10. ブラウザをリロード
11. 設定が保持されていることを確認
```

##### ゲームテスト手順（Game A例）
```
1. Home画面からGame Aを選択
2. 準備画面が表示されることを確認
3. 「はじめる」をクリック
4. ゲームが開始することを確認
5. ターゲットがレール上を移動することを確認
6. 一時停止ボタンをクリック
7. ゲームが一時停止することを確認
8. 「つづける」をクリック
9. ゲームが再開することを確認
10. ゲーム終了まで待つ
11. 結果画面が表示されることを確認
12. 「もういちど」をクリック
13. 同じゲームが再度開始することを確認
14. Escapeキーを押す
15. Home画面に戻ることを確認
```

---

## 4. 完了条件

### 4.1 機能テスト完了条件

| 項目 | 条件 |
|------|------|
| 画面遷移 | すべての遷移パターンが正常に動作 |
| ゲームプレイ | 各ゲームが開始から終了まで正常に動作 |
| 設定 | すべての設定項目が変更・保存・復元できる |
| 入力 | マウス・タッチ・キーボードすべてで操作可能 |

### 4.2 アクセシビリティテスト完了条件

| 項目 | 条件 |
|------|------|
| キーボード操作 | マウスなしで全機能が使用可能 |
| フォーカス表示 | フォーカス中の要素が常に視認可能 |
| 文字サイズ | 3段階の文字サイズが正しく反映 |
| 背景色 | 4種類の背景色が正しく反映 |

### 4.3 品質テスト完了条件

| 項目 | 条件 |
|------|------|
| エラー | コンソールにエラーが出力されない |
| メモリ | 長時間プレイでメモリリークがない |
| パフォーマンス | アニメーションがスムーズ（30fps以上） |
| 互換性 | 主要ブラウザで動作確認済み |

### 4.4 ドキュメント完了条件

| 項目 | 条件 |
|------|------|
| テスト結果 | 全項目のテスト結果が記録されている |
| バグ報告 | 発見されたバグがすべて報告されている |
| 修正確認 | 報告されたバグがすべて修正確認されている |

---

## 5. NG（禁止事項）

### 5.1 テスト実施に関するNG

| 禁止事項 | 理由 | 対応 |
|---------|------|------|
| 再現手順なしのバグ報告 | 修正困難 | 必ず再現手順を記載 |
| 環境情報なしのバグ報告 | 環境依存の特定困難 | ブラウザ・OS情報を記載 |
| テスト項目のスキップ | 品質低下 | 全項目を実施 |
| 曖昧な合格判定 | 品質基準の低下 | 明確な基準で判定 |

### 5.2 バグ修正に関するNG

| 禁止事項 | 理由 | 対応 |
|---------|------|------|
| 再現確認なしの「修正完了」 | 再発リスク | 必ず再現手順で確認 |
| 関連機能の未確認 | デグレード | 周辺機能も確認 |
| テストケース追加なし | 同類バグの見落とし | 関連テストを追加 |

### 5.3 報告に関するNG

| 禁止事項 | 理由 | 対応 |
|---------|------|------|
| 口頭のみの報告 | 記録が残らない | 必ず文書化 |
| 主観的な表現 | 判断困難 | 客観的な事実を記載 |
| 優先度の未設定 | 対応順序が不明確 | 必ず優先度を設定 |

---

## 6. 既知の問題と対応

### 6.1 ブラウザ固有の問題

| ブラウザ | 問題 | 対応 |
|---------|------|------|
| Safari | touch-action制約 | CSSで明示的に設定 |
| Firefox | focus-visible差異 | ポリフィル使用 |
| Edge | 古いバージョン対応 | ES2020以上を前提 |

### 6.2 デバイス固有の問題

| デバイス | 問題 | 対応 |
|---------|------|------|
| タブレット | タッチ精度 | ターゲットサイズ確保 |
| 小画面 | レイアウト崩れ | レスポンシブ対応 |
| 高DPI | 描画ぼやけ | devicePixelRatio対応 |

---

## 7. テスト環境

### 7.1 必須テスト環境

| 環境 | バージョン |
|------|-----------|
| Chrome | 最新版 |
| Firefox | 最新版 |
| Safari | 最新版 |
| Edge | 最新版 |

### 7.2 推奨テスト環境

| 環境 | 備考 |
|------|------|
| Windows PC | 主要ユーザー環境 |
| Mac | Safari対応確認 |
| iPad | タッチ操作確認 |
| Android タブレット | Chrome タッチ確認 |

### 7.3 テストツール

| ツール | 用途 |
|--------|------|
| Chrome DevTools | デバッグ、パフォーマンス計測 |
| Lighthouse | アクセシビリティ監査 |
| axe DevTools | アクセシビリティ詳細チェック |

---

*このドキュメントはAgent 05: QA & Debuggerによって作成されました*
*最終更新: 2026-01-16*
